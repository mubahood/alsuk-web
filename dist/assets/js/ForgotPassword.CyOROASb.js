var e=Object.defineProperty,s=Object.defineProperties,r=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,i=(s,r,a)=>r in s?e(s,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[r]=a,n=(e,s)=>{for(var r in s||(s={}))o.call(s,r)&&i(e,r,s[r]);if(a)for(var r of a(s))t.call(s,r)&&i(e,r,s[r]);return e},l=(e,a)=>s(e,r(a)),d=(e,s,r)=>new Promise(((a,o)=>{var t=e=>{try{n(r.next(e))}catch(s){o(s)}},i=e=>{try{n(r.throw(e))}catch(s){o(s)}},n=e=>e.done?a(e.value):Promise.resolve(e.value).then(t,i);n((r=r.apply(e,s)).next())}));import{j as c,A as m,F as p,B as x,S as u}from"./vendor-bootstrap.BZxWRyST.js";import{r as g,R as h}from"./vendor-react.CSr-5IoM.js";import{u as y,L as w}from"./vendor-routing.Dz6WPNpl.js";import{b as v}from"./vendor-redux.rUoA4kI-.js";import{q as j,v as b,w as f}from"./index.Cw3mZMWB.js";const P=()=>{const e=y(),s=v(),[r,a]=g.useState("request"),[o,t]=g.useState(""),[i,P]=g.useState({email:""}),[N,C]=g.useState({email:"",code:"",newPassword:"",confirmPassword:""}),[k,S]=g.useState({}),[E,z]=g.useState(!1),[R,F]=g.useState(""),[q,I]=g.useState("");h.useEffect((()=>(document.body.style.paddingTop="0",()=>{document.body.style.paddingTop="calc(56px + 35px + 0px)"})),[]);const O=e=>{const{name:s,value:a}=e.target;"request"===r?P((e=>l(n({},e),{[s]:a}))):C((e=>l(n({},e),{[s]:a}))),k[s]&&S((e=>l(n({},e),{[s]:void 0}))),R&&F(""),q&&I("")},B={minHeight:"100vh",background:"linear-gradient(135deg, var(--primary-color), var(--primary-color-dark))",display:"flex",margin:0,padding:0},T={flex:1,display:"flex",alignItems:"center",justifyContent:"center",color:"white",padding:"var(--spacing-6)",textAlign:"center",background:"linear-gradient(135deg, var(--primary-color) 0%, var(--primary-color-dark) 100%)"};return c.jsxs("div",{style:B,children:[c.jsx("div",{style:T,className:"d-none d-lg-flex",children:c.jsxs("div",{children:[c.jsx(w,{to:"/",className:"text-white text-decoration-none mb-4 d-block",children:c.jsx("div",{style:{backgroundColor:"white",padding:"16px 24px",borderRadius:"12px",marginBottom:"2rem",display:"inline-block"},children:c.jsx("img",{src:"/media/logos/alsuk-logo.png",alt:j.NAME,style:{maxHeight:"60px",maxWidth:"180px",objectFit:"contain"},onError:e=>{e.currentTarget.src="/media/logos/alsuk-logo-2.png"}})})}),c.jsx("h1",{style:{fontSize:"var(--font-size-3xl)",fontWeight:"bold",marginBottom:"var(--spacing-lg)",color:"white"},children:"request"===r?"Forgot Password?":"Reset Password"}),c.jsx("p",{style:{fontSize:"var(--font-size-lg)",opacity:.9,marginBottom:"var(--spacing-xl)",lineHeight:1.6},children:"request"===r?"Don't worry! It happens. Please enter your email address and we'll send you a reset code.":"Enter the reset code sent to your email along with your new password."}),c.jsxs("div",{style:{marginTop:"var(--spacing-xl)"},children:[c.jsxs("div",{style:{marginBottom:"var(--spacing-md)",display:"flex",alignItems:"center",justifyContent:"center",gap:"var(--spacing-sm)"},children:[c.jsx("i",{className:"bi bi-shield-check",style:{fontSize:"var(--font-size-xl)"}}),c.jsx("span",{children:"Secure Password Recovery"})]}),c.jsxs("div",{style:{marginBottom:"var(--spacing-md)",display:"flex",alignItems:"center",justifyContent:"center",gap:"var(--spacing-sm)"},children:[c.jsx("i",{className:"bi bi-envelope",style:{fontSize:"var(--font-size-xl)"}}),c.jsx("span",{children:"Email Verification Required"})]}),c.jsxs("div",{style:{marginBottom:"var(--spacing-md)",display:"flex",alignItems:"center",justifyContent:"center",gap:"var(--spacing-sm)"},children:[c.jsx("i",{className:"bi bi-clock",style:{fontSize:"var(--font-size-xl)"}}),c.jsx("span",{children:"Quick & Easy Process"})]})]})]})}),c.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"var(--bg-white)",padding:"var(--spacing-6)",margin:0},children:c.jsxs("div",{style:{width:"100%",maxWidth:"400px",padding:0},children:[c.jsx("div",{className:"text-center mb-4 d-lg-none",children:c.jsx(w,{to:"/",children:c.jsx("div",{style:{backgroundColor:"white",padding:"12px 16px",borderRadius:"8px",display:"inline-block",marginBottom:"1rem",border:"1px solid #e9ecef"},children:c.jsx("img",{src:"/media/logos/alsuk-logo.png",alt:j.NAME,style:{maxHeight:"45px",maxWidth:"150px",objectFit:"contain"},onError:e=>{e.currentTarget.src="/media/logos/alsuk-logo-2.png"}})})})}),c.jsxs("div",{className:"text-center mb-4",children:[c.jsx("h2",{className:"h3 fw-bold",children:"request"===r?"Forgot Password":"Reset Password"}),c.jsx("p",{className:"text-muted",children:"request"===r?"Enter your email to receive a reset code":`Enter the code sent to ${o}`})]}),R&&c.jsx(m,{variant:"danger",className:"mb-4",children:R}),q&&c.jsx(m,{variant:"success",className:"mb-4",children:q}),"request"===r?c.jsxs(p,{onSubmit:e=>d(void 0,null,(function*(){if(e.preventDefault(),(()=>{const e={};return i.email?/\S+@\S+\.\S+/.test(i.email)||(e.email="Please enter a valid email"):e.email="Email is required",S(e),0===Object.keys(e).length})()){z(!0),S({}),F(""),I("");try{const e=yield s(b(i.email));if(!e.success)throw new Error(e.error||"Failed to send password reset email");I(e.message||"Password reset code sent to your email"),t(i.email),C((e=>l(n({},e),{email:i.email}))),a("reset")}catch(r){const e=(null==r?void 0:r.message)||r||"Failed to send password reset email. Please try again.";F(e)}finally{z(!1)}}})),children:[c.jsxs(p.Group,{className:"mb-3",children:[c.jsx(p.Label,{children:"Email Address"}),c.jsx(p.Control,{type:"email",name:"email",value:i.email,onChange:O,isInvalid:!!k.email,placeholder:"Enter your email address",autoComplete:"email"}),c.jsx(p.Control.Feedback,{type:"invalid",children:k.email})]}),c.jsx(x,{type:"submit",variant:"primary",size:"lg",className:"w-100 mb-4",disabled:E,style:{backgroundColor:"var(--primary-color)",borderColor:"var(--primary-color)",borderRadius:"var(--border-radius)"},children:E?c.jsxs(c.Fragment,{children:[c.jsx(u,{size:"sm",className:"me-2"}),"Sending reset code..."]}):"Send Reset Code"}),c.jsxs("div",{className:"text-center",children:[c.jsx("span",{className:"text-muted",children:"Remember your password? "}),c.jsx(w,{to:"/auth/login",className:"text-decoration-none fw-semibold",style:{color:"var(--primary-color)"},children:"Sign in"})]})]}):c.jsxs(p,{onSubmit:r=>d(void 0,null,(function*(){if(r.preventDefault(),(()=>{const e={};return N.code?N.code.length<3&&(e.code="Please enter a valid reset code"):e.code="Reset code is required",N.newPassword?N.newPassword.length<4&&(e.newPassword="Password must be at least 4 characters"):e.newPassword="Password is required",N.confirmPassword?N.newPassword!==N.confirmPassword&&(e.confirmPassword="Passwords do not match"):e.confirmPassword="Please confirm your password",S(e),0===Object.keys(e).length})()){z(!0),S({}),F(""),I("");try{const r=yield s(f(N.email,N.code,N.newPassword));if(!r.success)throw new Error(r.error||"Failed to reset password");I(r.message||"Password reset successfully"),setTimeout((()=>{e("/auth/login")}),2e3)}catch(a){const e=(null==a?void 0:a.message)||a||"Failed to reset password. Please try again.";F(e)}finally{z(!1)}}})),children:[c.jsxs(p.Group,{className:"mb-3",children:[c.jsx(p.Label,{children:"Reset Code"}),c.jsx(p.Control,{type:"text",name:"code",value:N.code,onChange:O,isInvalid:!!k.code,placeholder:"Enter the reset code from your email"}),c.jsx(p.Control.Feedback,{type:"invalid",children:k.code})]}),c.jsxs(p.Group,{className:"mb-3",children:[c.jsx(p.Label,{children:"New Password"}),c.jsx(p.Control,{type:"password",name:"newPassword",value:N.newPassword,onChange:O,isInvalid:!!k.newPassword,placeholder:"Enter your new password",autoComplete:"new-password"}),c.jsx(p.Control.Feedback,{type:"invalid",children:k.newPassword})]}),c.jsxs(p.Group,{className:"mb-3",children:[c.jsx(p.Label,{children:"Confirm New Password"}),c.jsx(p.Control,{type:"password",name:"confirmPassword",value:N.confirmPassword,onChange:O,isInvalid:!!k.confirmPassword,placeholder:"Confirm your new password",autoComplete:"new-password"}),c.jsx(p.Control.Feedback,{type:"invalid",children:k.confirmPassword})]}),c.jsx(x,{type:"submit",variant:"primary",size:"lg",className:"w-100 mb-4",disabled:E,style:{backgroundColor:"var(--primary-color)",borderColor:"var(--primary-color)",borderRadius:"var(--border-radius)"},children:E?c.jsxs(c.Fragment,{children:[c.jsx(u,{size:"sm",className:"me-2"}),"Resetting password..."]}):"Reset Password"}),c.jsxs("div",{className:"text-center",children:[c.jsx("span",{className:"text-muted",children:"Need a new code? "}),c.jsx(w,{to:"#",className:"text-decoration-none fw-semibold",style:{color:"var(--primary-color)"},onClick:e=>{e.preventDefault(),a("request"),S({}),F(""),I("")},children:"Request again"})]})]}),c.jsx("div",{className:"text-center mt-4",children:c.jsxs(w,{to:"/",className:"text-muted text-decoration-none",style:{fontSize:"var(--font-size-sm)"},children:[c.jsx("i",{className:"bi bi-arrow-left"})," ","Back to Shopping"]})})]})})]})};export{P as default};
