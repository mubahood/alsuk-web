var e=Object.defineProperty,a=Object.defineProperties,s=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,l=(a,s,r)=>s in a?e(a,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[s]=r,i=(e,a)=>{for(var s in a||(a={}))n.call(a,s)&&l(e,s,a[s]);if(r)for(var s of r(a))t.call(a,s)&&l(e,s,a[s]);return e},o=(e,r)=>a(e,s(r));import{j as c}from"./vendor-bootstrap.BZxWRyST.js";import{r as m}from"./vendor-react.CSr-5IoM.js";import{L as d}from"./vendor-routing.Dz6WPNpl.js";import{u,b}from"./vendor-redux.rUoA4kI-.js";import{T as h,A as f,y as p}from"./index.Cw3mZMWB.js";import{A as x,a as j}from"./AccountCard.BpNSsxGb.js";const v=()=>{const{user:e}=u((e=>e.auth)),a=b(),[s,r]=m.useState(!1),[n,t]=m.useState(!1),[l,v]=m.useState(!1),[_,N]=m.useState({}),[y,g]=m.useState({first_name:"",last_name:"",email:"",phone_number:"",dob:"",sex:"",intro:""});m.useEffect((()=>{if(e){const a={first_name:e.first_name||"",last_name:e.last_name||"",email:e.email||"",phone_number:e.phone_number_1||"",dob:e.date_of_birth||"",sex:e.sex||"",intro:e.intro||""};g(a)}}),[e]);const P=e=>{const{name:a,value:s}=e.target;g((e=>o(i({},e),{[a]:s}))),_[a]&&N((e=>{const s=i({},e);return delete s[a],s}))};return c.jsxs(x,{title:"My Profile",subtitle:"Manage your personal information and account settings",icon:"bi-person",headerActions:s?c.jsxs("div",{className:"d-flex gap-2",children:[c.jsx("button",{className:"btn btn-outline-secondary",onClick:()=>{if(r(!1),N({}),e){const a={first_name:e.first_name||"",last_name:e.last_name||"",email:e.email||"",phone_number:e.phone_number_1||"",dob:e.date_of_birth||"",sex:e.sex||"",intro:e.intro||""};g(a)}},disabled:l,children:"Cancel"}),c.jsx("button",{className:"btn btn-primary",onClick:()=>{return e=void 0,s=null,n=function*(){if((()=>{const e={};return(!y.first_name.trim()||y.first_name.trim().length<2)&&(e.first_name="First name is required and must be at least 2 characters"),(!y.last_name.trim()||y.last_name.trim().length<2)&&(e.last_name="Last name is required and must be at least 2 characters"),(!y.phone_number.trim()||y.phone_number.trim().length<5)&&(e.phone_number="Phone number is required and must be at least 5 characters"),y.email&&y.email.trim()&&(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(y.email.trim())||(e.email="Please enter a valid email address")),y.intro&&y.intro.length>500&&(e.intro="Introduction must be less than 500 characters"),N(e),0===Object.keys(e).length})()){v(!0);try{const e=yield f.updateProfile(o(i({},y),{phone_number:y.phone_number,dob:y.dob}));if(!e.success)throw new Error(e.message||"Failed to update profile");a(p(e.data)),r(!1),t(!0),h.success("Profile updated successfully"),setTimeout((()=>t(!1)),3e3)}catch(e){h.error(e instanceof Error?e.message:"Failed to update profile")}finally{v(!1)}}else h.error("Please correct the errors below")},new Promise(((a,r)=>{var t=e=>{try{i(n.next(e))}catch(a){r(a)}},l=e=>{try{i(n.throw(e))}catch(a){r(a)}},i=e=>e.done?a(e.value):Promise.resolve(e.value).then(t,l);i((n=n.apply(e,s)).next())}));var e,s,n},disabled:l,children:l?c.jsxs(c.Fragment,{children:[c.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):c.jsxs(c.Fragment,{children:[c.jsx("i",{className:"bi-check me-2"}),"Save Changes"]})})]}):c.jsxs("button",{className:"btn btn-primary",onClick:()=>{r(!0),N({})},children:[c.jsx("i",{className:"bi-pencil me-2"}),"Edit Profile"]}),children:[n&&c.jsx(j,{className:"success-border",children:c.jsxs("div",{className:"text-success text-center",children:[c.jsx("i",{className:"bi-check-circle-fill me-2"}),"Profile updated successfully!"]})}),c.jsx(j,{title:"Personal Information",subtitle:"Your basic information and contact details",icon:"bi-person-lines-fill",children:c.jsxs("div",{className:"row",children:[c.jsxs("div",{className:"col-md-6 mb-3",children:[c.jsx("label",{className:"form-label",children:"First Name *"}),c.jsx("input",{type:"text",name:"first_name",value:y.first_name,onChange:P,className:"form-control "+(_.first_name?"is-invalid":""),disabled:!s,placeholder:"Enter your first name"}),_.first_name&&c.jsx("div",{className:"invalid-feedback",children:_.first_name})]}),c.jsxs("div",{className:"col-md-6 mb-3",children:[c.jsx("label",{className:"form-label",children:"Last Name *"}),c.jsx("input",{type:"text",name:"last_name",value:y.last_name,onChange:P,className:"form-control "+(_.last_name?"is-invalid":""),disabled:!s,placeholder:"Enter your last name"}),_.last_name&&c.jsx("div",{className:"invalid-feedback",children:_.last_name})]}),c.jsxs("div",{className:"col-md-6 mb-3",children:[c.jsx("label",{className:"form-label",children:"Email Address"}),c.jsx("input",{type:"email",name:"email",value:y.email,onChange:P,className:"form-control "+(_.email?"is-invalid":""),disabled:!s,placeholder:"Enter your email address"}),_.email&&c.jsx("div",{className:"invalid-feedback",children:_.email})]}),c.jsxs("div",{className:"col-md-6 mb-3",children:[c.jsx("label",{className:"form-label",children:"Phone Number *"}),c.jsx("input",{type:"tel",name:"phone_number",value:y.phone_number,onChange:P,className:"form-control "+(_.phone_number?"is-invalid":""),disabled:!s,placeholder:"Enter your phone number"}),_.phone_number&&c.jsx("div",{className:"invalid-feedback",children:_.phone_number})]}),c.jsxs("div",{className:"col-md-6 mb-3",children:[c.jsx("label",{className:"form-label",children:"Date of Birth"}),c.jsx("input",{type:"date",name:"dob",value:y.dob,onChange:P,className:"form-control",disabled:!s})]}),c.jsxs("div",{className:"col-md-6 mb-3",children:[c.jsx("label",{className:"form-label",children:"Gender"}),c.jsxs("select",{name:"sex",value:y.sex,onChange:P,className:"form-select",disabled:!s,children:[c.jsx("option",{value:"",children:"Select Gender"}),c.jsx("option",{value:"Male",children:"Male"}),c.jsx("option",{value:"Female",children:"Female"}),c.jsx("option",{value:"Other",children:"Other"})]})]}),c.jsxs("div",{className:"col-12 mb-3",children:[c.jsx("label",{className:"form-label",children:"Introduction"}),c.jsx("textarea",{name:"intro",value:y.intro,onChange:P,className:"form-control "+(_.intro?"is-invalid":""),disabled:!s,placeholder:"Tell us about yourself...",rows:4,maxLength:500}),_.intro&&c.jsx("div",{className:"invalid-feedback",children:_.intro}),c.jsxs("div",{className:"form-text",children:[y.intro.length,"/500 characters"]})]})]})}),c.jsx(j,{title:"Account Security",subtitle:"Manage your account security settings",icon:"bi-shield-check",children:c.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[c.jsxs("div",{children:[c.jsx("h6",{className:"mb-1",children:"Password"}),c.jsx("p",{className:"text-muted mb-0",children:"Keep your account secure with a strong password"})]}),c.jsxs(d,{to:"/account/settings",className:"btn btn-outline-primary btn-sm",children:[c.jsx("i",{className:"bi-gear me-2"}),"Security Settings"]})]})})]})};export{v as default};
